### Анализ АВ тестов воронки.

[Хи квадрат  на хабре](https://habr.com/ru/companies/mygames/articles/677074/)  

    Как вы проводите АБ тесты воронок? Допустим показы-клики-добавление в корзину - покупка.
    Анализируется каждый этап отдельно или ищите изменение во всей воронке сразу?
<details>
  
1. В статье неверно предполагается считать конверсию — на практике реальная конверсия   
   по когортам новых, старых и по устройствам будет другая.   
  
2. Конверсии по лендингам в 90% компаний считается не верно и это ставит крест на АБ тестах.  
  Если в расчете конверсий есть систематическая погрешность измерения, связанная с   
  ошибкой определения лендингом в счетчиках аналитики или самописных системах.   

  Статья теоритическая из-за этих предположений не очень применима на практике   

3. Корреляция между этапами воронки на практике под сомнениями (Возможны разные варианты для разных отраслей)
4. 
</details>


Пример воронки: показы - клики - добавление в корзину - покупка.  
Пример анализа:  
1. По каждому этапу отдельно
2. По всем этапам
3. По определенным этапам
4. По целевой метрике

Подходы:  
1. Смотрим на целевую метрику  (на что хотим повлиять, для чего запустили АВ).  
   Пример - конверсия в платящего или увеличение Retention
2. Зависит от того что мы хотим повлиять:  
   1. Изменение конверсии на определённом этапе  
   2. Изменение всей воронки  
   3. Комбинация этих двух вариантов  
   Важно: заранее в дизайне заложить способ оценки, чтобы не искать после "статзначимость".
   Не гоже, p-haching-ом заниматься.

Критика классической модели воронки от Красинского:  
Исходим из того, что существует вероятность перехода в среднем для всех пользователей  
из шага А в шаг Б — как причину.  
Это понятная модель, потому что для каждого пользователя в отдельности она применима.  
А вот для всей генеральной совокупности — не очень.  

Вот я сейчас занимаюсь воронками на серверисе одном из лидеров рынка...  
Тут 100500 сегментов, которые ищут запчасти разными способами.  
Какие в жопу, простите вероятности перехода между шагами?  
Для каждого из сегментов сценарии отличаются, некоторые и не хотят переходить дальше.  

Сценарии разные, джобы разные, отвал на разных шагах разный. На одном сегменте конверсию  
поднимаем, другим ломаем.  
Сама по себе объяснительная модель классической воронки — это огомное упрощение,  
которая в 2025 году ну прям мешает жить.  

Критики статьи от Аналитки на кубах:  
она сильно переусложнена — с точки зрения статистики можно проще рассказывать,  
с точки зрения бизнеса — некоторые вещи вообще странновато выглядят, особенно в последней трети статьи)  

Пост комментарий от Аналитки на кубах:  
Вячеслав Зотов из WhaleKit написал настоящий лонгрид про тесты хи-квадрат.  
В статье последовательно рассматривается, что за распределение хи-квадрат,  
семейство тестов на основе этого распределения, связь с z-тестом,  
рекомендуемый размер выборки и, в завершение всего, применимость тестов хи-квадрат к анализу воронок.  

Очень понравилась структура статьи, все как в лучших домах. В частности, культура  
аргументации: на каждый тезис есть или пример, или симуляционный эксперимент и/или  
ссылка на CrossValidated и аналогичные ресурсы, где преимущественно разбирается  
математическая часть. Ссылки, наверное, самое важное для меня в этой статье,  
следом идет код экспериментов.  

Тем не менее, кто-то из хабражителей оставил комментарий, с которым я, признаться, согласен:  
"ощущение, что это пятая статья из цикла. Напишите, пожалуйста, первые четыре".  
Действительно, статью можно было разделить на несколько частей, а кое-что даже и сократить.  

Ряд пунктов вызвал некоторое сомнение. По большей части это блоки, касающиеся мощности тестов.  
Так, тезис "если в ячейке меньше 5 наблюдений, то можно просто умножить таблицу на нужное число"  
сразу навевает мысли о p-хакинге, мы так в студенчестве баловались.  
В параграфе про размер выборки также есть фраза "с ростом размера выборки статистика растет  
линейно, при этом p-value стремится к 0 и рано или поздно тест покажет статистически значимые  
отличия при исходных пропорциях". Кажется, что это очевидно, что с ростом выборки растет мощность  
и даже самые маленькие различия в какой-то момент могут быть признаны значимыми,  
просто потому что так сконструирован тест. Собственно именно поэтому в классическом анализе  
мы определяем размер эффекта и рассчитываем необходимую выборку при заданных мощности и значимости.  

Блок про анализ воронок масштабный (с трудом продрался через него, честно говоря) и достоин отдельной  
статьи. Хи-квадрат как критерий согласия позволяет сравнивать категориальные данных больше чем 2*2 и  
это можно использовать при сравнении воронок, особенностям такого анализа и посвящен весь этот блок.  
Однако сама задача вызывает у меня некоторое недоумение. Зачем сравнивать воронки целиком,  
когда проще и нагляднее сравнить именно конверсию в какой-то конкретный шаг?  
Нас же обычно интересуют конкретные шаги и точечные изменения в воронках.  

Всегда интересно, о чем думают коллеги по цеху. Аналитики в геймдеве почему-то очень скрытные.  
В целом же статья лично для меня стала прекрасной иллюстрацией, что если что-то придумал -- делай сразу.  
Я года полтора-два назад хотел своим коллегам на каком-нибудь R&D-дне рассказать про хи-квадрат,  
но много откладывал. В результате Вячеслав "успел раньше". Что ж, как минимум, я теперь смогу  
опираться на его, бесспорно, богатый материал.  

https://www.youtube.com/watch?v=h8JfN0hDmDY

